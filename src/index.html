<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Headless Transition</title>
    <style>
      /* 一些简单的过渡效果的样式 */
      .before-enter {
        opacity: 0;
        transform: translateY(-10px);
        transition: opacity 3s, transform 3s;
      }

      .after-enter {
        opacity: 1;
        transform: translateY(0);
        transition: opacity 3s, transform 3s;
      }

      .before-leave {
        opacity: 1;
        transform: translateY(0);
        transition: opacity 3s, transform 3s;
      }

      .after-leave {
        opacity: 0;
        transform: translateY(-10px);
        transition: opacity 3s, transform 3s;
      }
    </style>
  </head>

  <script type="module" src="/main.ts"></script>
  <body>
    <headless-transition
      id="transition-element"
      appear
      class="before-enter"
      after-enter-class="after-enter"
      before-leave-class="before-leave"
      after-leave-class="after-leave"
    >
      <div style="padding: 20px; background-color: lightblue">This is a transition content.</div>
    </headless-transition>
    <button id="toggle-button">Toggle Transition</button>
    <click-outside id="click-outside-element">
      <div>
        <div style="padding: 20px; background-color: lightcoral">
          This is a click-outside content.
        </div>
      </div>
    </click-outside>

    <context-provider id="context-provider" key="test">
      <div style="padding: 20px; background-color: lightgreen">
        This is a context-provider content.
        <context-consumer id="context-consumer" key="test"></context-consumer>
      </div>
    </context-provider>
    <button id="context-button">Change Context</button>
    <div>
      <headless-tab default-value="tab1">
        <headless-tab-trigger value="tab1">
          <span>Tab 1</span>
        </headless-tab-trigger>
        <headless-tab-trigger value="tab2">
          <span>Tab 2</span>
        </headless-tab-trigger>
        <headless-tab-content value="tab1">
          <span>Tab 1 Content</span>
        </headless-tab-content>
        <headless-tab-content value="tab2" style="display: none">
          <span>Tab 2 Content</span>
        </headless-tab-content>
      </headless-tab>
    </div>

    <script type="module">
      const toggleButton = document.getElementById('toggle-button');
      const transitionElement = document.getElementById('transition-element');
      const clickOutsideElement = document.getElementById('click-outside-element');
      const providerElement = document.getElementById('context-provider');
      const consumerElement = document.getElementById('context-consumer');
      const contextButton = document.getElementById('context-button');

      clickOutsideElement.onClickOutside = () => {
        // console.log('ClickOutside');
      };
      transitionElement.afterEnter = () => {
        // console.log('afterEnter');
      };
      transitionElement.afterLeave = () => {
        console.log('afterLeave');
      };
      toggleButton.addEventListener('click', () => {
        // 切换 show 属性来触发 enter/leave 过渡
        transitionElement.show = !transitionElement.show;
      });

      consumerElement.onContextChange = (context) => {
        console.log('consumer received context change', context);
      };

      contextButton.onclick = () => {
        providerElement.setContext({ a: 1 });
      };
    </script>
  </body>
</html>
